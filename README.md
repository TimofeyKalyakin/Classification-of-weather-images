# Classification-of-weather-images

## Описание проекта

Данный проект был разработан в рамках проектного практикума - хакатона магистерской программы МФТИ "Науки о данных".  
Команда №14 состояла из:
1. Калякин Тимофей  
2. Тарковский Роман  
3. Булхуков Абя  
4. Подюков Иван  
5. Кучин Алексей  
6. Круглий Никита  

Проект посвящён классификации фотографий с различными визуальными проявлениями погодных условий.  
Основная идея:  
Модель анализирует фотографию, определяя погодные условия (туман, дождь, снег, солнечно и т.п.). Потенциальный сценарий использования:  
- Пользователь загружает фотографию и указывает геолокацию (или вводит адрес), чтобы получить информацию о погоде на момент съёмки.  
- Данные можно использовать для валидации метеорологических прогнозов или уточнения показаний датчиков, аналогично подходу, применяемому в "Яндекс.Погоде".  

В будущем эту функциональность можно встроить в устройства, такие как камеры или дроны, используя технологии **tinyML**.  

Для реализации проекта были созданы две модели машинного обучения:  
1. **На базе VGG16** для высокоточной классификации.  
2. **tinyML-модель**, оптимизированная для устройств с ограниченными вычислительными ресурсами.  

Кроме того, для демонстрации возможностей была разработана интеграция с Telegram-ботом:  
[@weatherrecognitionbot](https://t.me/weatherrecognitionbot)  

---

## Использованные данные

Для обучения и тестирования была использована публичная выборка изображений с Kaggle:  
[Weather Dataset](https://www.kaggle.com/datasets/jehanbhathena/weather-dataset).  

---

## Модель на базе VGG16

**VGG16** — популярная архитектура сверточных нейронных сетей, хорошо зарекомендовавшая себя в задачах классификации изображений.  

Для обучения использовалась предобученная версия модели с дообучением на новых данных.  
Применялись следующие техники аугментации:  
- **Случайное горизонтальное отражение** (*RandomHorizontalFlip*).  
- **Изменение яркости, контраста и насыщенности** (*ColorJitter*).  
- **Преобразование в оттенки серого с заданной вероятностью** (*RandomGrayscale*).  

Результаты:  
- Точность на тренировочной выборке: **99%**  
- Точность на тестовой выборке: **95%**  

Код обучения и сама модель находятся в папке `VGG16`.  

---

## Модель для tinyML

Для работы на устройствах с ограниченными ресурсами была разработана облегчённая модель.  
Ключевые этапы:
1. Обучение компактной сверточной нейронной сети (CNN).  
2. Преобразование модели в формат TensorFlow Lite (*TFLite*) с полной квантизацией, что позволяет значительно уменьшить размер модели и ускорить её работу.  

**Размер модели**: '.h5': ~844 КБ; '.tflite' ~78 КБ.
**Использование:**  
- Модель готова к интеграции в устройства IoT, камеры или дроны.  

Репозиторий содержит:  
- Ноутбук с процессом обучения;
- Обученную модель;
- Квантизированную модель;
- Пример использования модели для визуальной проверки классификации (папка `tinyML`).  

---

## Telegram-бот

Для демонстрации возможностей модели VGG16 был разработан Telegram-бот:  
[@weatherrecognitionbot](https://t.me/weatherrecognitionbot).  

Бот принимает фотографию и возвращает предполагаемую информацию о погодных условиях на основе обученной модели.  

---

## Структура репозитория

- `VGG16/` — ноутбук с кодом обучения, предобученная модель.  
- `tinyML/` — ноутбук с процессом обучения и квантизации, квантизированная модель, тестовые изображения.  
- `README.md` — описание проекта.  

---

### Как запустить?

#### Для локального запуска:
1. Установите необходимые библиотеки используя ```pip install```:
   
2. Скачайте и подготовьте данные:
```
import kagglehub

# Download latest version
path = kagglehub.dataset_download("jehanbhathena/weather-dataset")

print("Path to dataset files:", path) 
```

3. Запустите обучающий ноутбук из папки `VGG16` или `tinyML`.  

#### Для использования Telegram-бота:
1. Убедитесь, что бот активен ([@weatherrecognitionbot](https://t.me/weatherrecognitionbot)).  
2. Отправьте фотографию и следуйте инструкциям.  

--- 

## Примечания

Проект остаётся в стадии разработки, и дальнейшие улучшения включают:  
- Интеграцию tinyML-модели с реальными устройствами.  
- Добавление временной привязки к снимкам для анализа изменений погоды.  
- Увеличение точности модели за счёт расширения тренировочной выборки и добавления новых параметров.  

